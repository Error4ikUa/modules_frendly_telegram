from .. import loader, utils
import asyncio

class SpizdMod(loader.Module):
    strings = {
        "name": "Spizd",
        "description": "–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –≤—ñ–¥–µ–æ —Ç–∞ —Ñ–æ—Ç–æ –∑ YouTube, Instagram —Ç–∞ Pinterest.",
        "usage": ".spizd <–ø–æ—Å–∏–ª–∞–Ω–Ω—è> ‚Äî –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î –º–µ–¥—ñ–∞ –∑ –≤–∫–∞–∑–∞–Ω–æ–≥–æ –¥–∂–µ—Ä–µ–ª–∞ (YouTube, Instagram, Pinterest)"
    }

    async def client_ready(self, client, db):
        self.client = client

    async def spizdcmd(self, message):
        args = utils.get_args_raw(message)
        if not args:
            await message.edit("‚ùå –í–∫–∞–∂—ñ—Ç—å –ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ –∫–æ–Ω—Ç–µ–Ω—Ç.")
            return

        bot_entity = "@TopSaverBot"
        await message.edit(f"‚è≥ –û—á—ñ–∫—É—î–º–æ –º–µ–¥—ñ–∞, –ø–æ—Ä–Ω–æ—Ñ–æ–Ω–¥–µ–π—à–Ω")
        await asyncio.sleep(2)
        await message.edit(f"ü§ôüèª —â–∞ —â–∞ –≤—Å—å–æ –±—É–¥–µüòé")
        await self.client.send_message(bot_entity, args)

        await asyncio.sleep(5)

        async for response in self.client.iter_messages(bot_entity, limit=5):
            if response.video:
                await message.respond(file=response.video)
                await message.delete()
                return
            elif response.photo:
                await message.respond(file=response.photo)
                await message.delete()
                return

        await message.edit("‚ö†Ô∏è –ù–µ –≤–¥–∞–ª–æ—Å—è –∑–Ω–∞–π—Ç–∏ –º–µ–¥—ñ–∞ –∑–∞ —Ü–∏–º –ø–æ—Å–∏–ª–∞–Ω–Ω—è–º.")
