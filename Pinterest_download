from .. import loader, utils
import asyncio

class PintrMod(loader.Module):
    strings = {"name": "Pintr"}

    async def client_ready(self, client, db):
        self.client = client

    async def pintrcmd(self, message):
        args = utils.get_args_raw(message)
        if not args:
            await message.edit("❌ Вкажіть посилання.")
            return

        bot_entity = await self.client.get_entity("@TopSaverBot")
        await self.client.send_message(bot_entity, args)
        await message.edit("⏳ поки очікуємо відео хочу сказати що кохаю Віку, ладно вот відео..."")

        async with self.client.conversation(bot_entity) as conv:
            try:
                response = await conv.get_response(timeout=15)
                if response.media:
                    await message.respond(file=response.media)
                    await message.delete()
                else:
                    await message.edit("⚠️ Відповідь не містить відео.")
            except asyncio.TimeoutError:
                await message.edit("⚠️ Бот не відповів вчасно.")
