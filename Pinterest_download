from .. import loader, utils
import asyncio

class PintrMod(loader.Module):
    strings = {"name": "Pintrest_download"}

    async def client_ready(self, client, db):
        self.client = client

    async def pintrcmd(self, message):
        args = utils.get_args_raw(message)
        if not args:
            await message.edit("❌ Вкажіть посилання.")
            return

        bot_entity = await self.client.get_entity("@TopSaverBot")
        await self.client.send_message(bot_entity, args)
        await message.edit("⏳ Очікуємо відео, о господи які ж в тебе цицьки...")

        try:
            async for response in self.client.iter_messages(bot_entity, limit=5):
                if response.media:
                    await message.respond(file=response.media)
                    await message.delete()
                    return
            await message.edit("⚠️ Бот не надіслав відео.")
        except asyncio.TimeoutError:
            await message.edit("⚠️ Бот не відповів вчасно.")
