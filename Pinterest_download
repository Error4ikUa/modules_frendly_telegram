from .. import loader, utils
import asyncio

class PintrMod(loader.Module):
    strings = {"name": "Pintr"}

    async def client_ready(self, client, db):
        self.client = client

    async def pintrcmd(self, message):
        args = utils.get_args_raw(message)
        if not args:
            await message.edit("❌ Please provide a link.")
            return
        
        bot_entity = await self.client.get_entity("@TopSaverBot")
        
        await self.client.send_message(bot_entity, args)
        await message.edit("⏳ Waiting for the video...")

        async with self.client.conversation(bot_entity) as conv:
            try:
                response = await conv.get_response(timeout=60)
                if response.media:
                    await message.respond("✅ Here is the video from the provided link:", file=response.media)
                else:
                    await message.respond("⚠️ No media found in response.")
            except asyncio.TimeoutError:
                await message.edit("⚠️ The bot did not respond in time.")
