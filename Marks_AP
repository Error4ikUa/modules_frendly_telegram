from .. import loader
from selenium import webdriver
from selenium.webdriver.chrome.options import Options
import asyncio

@loader.tds
class MarksModule(loader.Module):
    strings = {"name": "Marks"}

    @loader.command()
    async def marks(self, message):
        url = "http://bit.ly/3RnfMpR"
        await message.edit("Загружаю убогу таблицю даунів...")
        
        try:
            chrome_options = Options()
            chrome_options.add_argument("--headless")
            chrome_options.add_argument("--disable-gpu")
            chrome_options.add_argument("--no-sandbox")
            chrome_options.add_argument("--disable-dev-shm-usage")

            driver = webdriver.Chrome(options=chrome_options)

            driver.get(url)
            screenshot_path = "/tmp/marks_table.png"
            driver.save_screenshot(screenshot_path)
            driver.quit()

            await message.client.send_file(
                message.chat_id,
                screenshot_path,
                caption="полюбуйтеся говном:"
            )
            await message.delete()
        except Exception as e:
            await message.edit(f"Ошибка: {e}")
